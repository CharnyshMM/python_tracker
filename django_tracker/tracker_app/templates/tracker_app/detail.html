{% extends 'tracker_app/base.html' %}

{% block title %}{{task.title}}{% endblock %}

{% block content %}

        <h1>{{task.title}}</h1>
        <a href="{% url 'new_task' task.id %}">
            <button type="button" class="btn btn-info btn-sm">Create Subtask</button>
        </a>
        <a href="{% url 'edit_task' task.id  %}">
            <button type="button" class="btn btn-warning btn-sm">Edit</button>
        </a>

        <a href="{% url 'delete_task' task.id %}">
            <button type="button" class="btn btn-danger btn-sm">Delete</button>
        </a>

        <div class="dropdown show">
                <button class="btn btn-primary dropdown-toggle" type="button" id="plans" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                 Plans
                </button>
                 <div class="dropdown-menu" aria-labelledby="plans">

                        {% if template_for_plan %}
                            <a class="dropdown-item" href="{% url 'delete_plan' template_for_plan.id %}">Delete plan</a>
                        {% else %}
                            <a class="dropdown-item" href="{% url 'new_plan' task.id %}">New Plan</a>
                        {% endif %}
                    <div class="dropdown-divider"></div>
                        {% if created_by_plan %}
                            <a class="dropdown-item" href="{% url 'delete_plan' created_by_plan.id %}">Delete plan that created task</a>
                        {% endif %}
                </div>


    </div>
    <hr/>
    <table>
        <tr>
            <td>
                <ul class="list-group">
                    <li class="list-group-item"><i>Author</i>: {{task.author}}</li>
                    <li class="list-group-item"><i>Starts</i>: {{task.start_time}}</li>
                    <li class="list-group-item"><i>Ends</i>: {{task.end_time}}</li>
                    {% if task.get_parent  %}
                        <li class="list-group-item"><i>Parent</i>: <a href="{% url 'detail_task' task.get_parent.id %}">{{task.get_parent.title}}</a></li>
                    {% endif %}
                    <li class="list-group-item"><i>Editors</i>: {{editors}}</li>
                    {% if created_by_plan %}
                        <li class="list-group-item"><i>Created automatically by plan</i></li>
                    {% endif %}
                    {% if template_for_plan %}
                        <li class="list-group-item"><i>This task has a plan set</i></li>
                    {% endif %}
                </ul>
            </td>
            <td>
                {% if template_for_plan %}
                 <ul class="list-group">
                     <li class="list-group-item active">Periodic Plan</li>
                     <li class="list-group-item"><i>Period</i>: {{p.period}}</li>
                     <li class="list-group-item"><i>Ends</i>: {{p.end_time}}</li>
                     <li class="list-group-item"><i>Last update</i>: {{p.last_update_time}}</li>

                </ul>
                {% endif %}
            </td>
        </tr>
    </table>

    {% if subtasks %}
        <h2>Subtasks:</h2>
        <ol>
        {% for subtask in subtasks %}

            <li><a href="{% url 'detail_task' subtask.id %}"> {{subtask.title}} </a></li>

        {% endfor %}
        </ol>
    {% endif %}

{% endblock %}